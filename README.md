# ClaudeCode-Kiro-Workflow

<div align="center">

![Version](https://img.shields.io/badge/version-3.0.0-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Claude Code](https://img.shields.io/badge/Claude%20Code-Compatible-purple.svg)

**专为 Claude Code 优化的规范驱动开发工作流系统**

[简体中文](./README.md) | [English](./docs/README_EN.md)

</div>

## 🚀 概述

ClaudeCode-Kiro-Workflow 是专为 Claude Code 设计的 AI 驱动开发工作流系统。灵感来源于 Kiro IDE 的 SPECS（规范驱动开发）工作流，将这一成熟的开发方法论引入到 Claude Code 中。系统引导开发者完成从需求到实现的结构化流程，具备自动数据库备份、Git 分支隔离、会话无缝恢复等安全特性，确保开发过程高效且安全。

本系统使用 Claude Code 的 `.claude/commands` 机制，提供简化的命令系统和原生中文交互支持。

## 参考来源

- **核心灵感**：Kiro IDE 的 SPECS 工作流系统
- **方法论**：规范驱动开发（Specification-Driven Development）
- **运行环境**：针对 Claude Code（Anthropic 官方 CLI）优化
- **命令系统**：直接使用自包含的 `.claude/commands/` 斜杠命令

## 核心特性

1. **AI 引导工作流**：自动推进 需求 → 设计 → 任务 → 执行 各阶段
2. **极简命令系统**：仅需使用 10 个核心命令
3. **中文原生交互**：与 AI 进行自然流畅的中文对话
4. **数据库自动备份**：开发前智能检测并主动备份数据库，防止数据丢失
5. **Git 分支隔离**：自动创建功能分支，保护主分支不受影响
6. **会话连续性**：跨会话无缝保持项目上下文，支持断点恢复
7. **进度实时跟踪**：任务状态实时更新，自动持久化保存

## 🗂️ 系统架构

这个系统采用**单层整合架构**设计：

### 自包含命令系统
```
.claude/commands/          # 完整的自包含命令系统
├── kiro-start.md         # 🚀 核心命令 - 包含完整的需求/设计/任务生成逻辑
├── kiro-next.md          # ⚡ 任务执行 - 包含单任务执行和进度跟踪逻辑
├── kiro-save.md          # 💾 进度保存 - 包含会话状态持久化逻辑
├── kiro-load.md          # 🔄 状态恢复 - 包含完整的上下文恢复逻辑
├── kiro-think.md         # 🧠 深度分析 - 包含多级分析和变更管理逻辑
├── kiro-change.md        # 📝 文档同步 - 包含原子性文档更新逻辑
├── kiro-end.md           # 🏁 功能完成 - 包含归档和清理逻辑
├── kiro-info.md          # ℹ️  项目配置 - 包含项目信息管理逻辑
├── kiro-status.md        # 📊 状态显示 - 包含进度计算和状态报告逻辑
└── kiro-git.md           # 🔗 代码提交 - 包含Git操作和提交逻辑
```

### 全局配置
```
CLAUDE.md                 # 全局规则和配置
├── 错误处理策略           # 统一的错误处理规范
├── 用户交互原则           # 确认和沟通规范
├── 文件操作标准           # 原子更新和备份策略
└── 数据库备份规则         # 自动备份和安全策略
```

**工作原理：**
- **每个命令都是完全自包含的**，包含执行所需的全部逻辑和模板
- **CLAUDE.md** 提供全局行为规范和错误处理策略
- **用户只需复制两个组件**：`.claude/commands/` 目录和 `CLAUDE.md` 文件
- **无需额外依赖**，命令内部包含所有工作流模板和规则

## 🚀 快速开始

### 安装配置

1. **克隆项目**
```bash
git clone https://github.com/heihuzicity-tech/ClaudeCode-Kiro-Workflow.git
cd ClaudeCode-Kiro-Workflow
```

2. **极简安装 - 仅需复制两个组件**
```bash
# 进入你的项目目录
cd /path/to/your-project

# 复制完整的命令系统和全局配置
cp -r ClaudeCode-Kiro-Workflow/.claude ./
cp ClaudeCode-Kiro-Workflow/CLAUDE.md ./
```

3. **验证安装**
```bash
ls .claude/commands/      # 应该显示10个自包含的命令文件
ls -la CLAUDE.md          # 确认全局配置文件存在

# 测试命令
# 在 Claude Code 中输入 /kiro-start 应该可以正常工作
```

### 基本使用

**直接使用斜杠命令（推荐）**
```
用户：/kiro-start 用户登录功能
AI：启动用户登录功能开发...
    [自动执行完整的启动流程]
    - 检测数据库配置并提示备份
    - 创建功能分支：feature/用户登录功能  
    - 创建 requirements.md（需求文档）
    - 创建 design.md（设计文档）
    - 创建 tasks.md（任务列表）

用户：/kiro-next
AI：执行下一个任务...
    [自动读取所有SPECS文档，执行单个任务]

用户：/kiro-save
AI：保存当前进度...
    [创建完整的会话恢复文件]

用户：/kiro-load
AI：恢复上次的工作状态...
    [完整恢复项目上下文和进度]
```

## 📋 工作流程详解

### 阶段一：需求分析 (`requirements.md`)
将模糊的想法转化为结构化需求文档
- 自动生成用户故事格式："作为[角色]，我想要[功能]，以便[收益]"
- 使用 EARS 语法编写验收标准："当[条件]时，系统应该[响应]"
- 用户确认后进入设计阶段

### 阶段二：技术设计 (`design.md`)
基于需求创建综合技术方案
- 分析现有代码架构和技术栈
- 设计系统组件和接口
- 制定数据模型和错误处理策略
- 包含测试方案

### 阶段三：任务规划 (`tasks.md`)
将设计分解为可执行的开发任务
- 使用层级编号（1.1, 1.2, 2.1）组织任务
- 每个任务包含具体的实现要求
- 只关注编码相关任务，避免非技术任务
- 任务间建立清晰的依赖关系

### 阶段四：代码实现 (`execution.md`)
严格按照任务列表执行开发
- 一次只执行一个任务
- 实时更新任务完成状态
- 执行前自动读取所有 SPECS 文档
- 任务完成后等待用户确认

## 🛡️ 安全特性

### 数据保护
- **自动数据库备份**：检测到数据库配置时自动提示备份
- **分支隔离开发**：每个功能在独立分支上开发，保护主分支
- **原子性更新**：文档更新要么全部成功，要么全部回滚

### 错误处理
- **优雅降级**：遇到错误时停止执行，提供解决建议
- **状态恢复**：支持从断点继续，不丢失工作进度
- **用户交互**：所有错误恢复都需要用户确认

### 会话管理
- **进度持久化**：`kiro-save` 生成完整的会话恢复提示
- **跨会话恢复**：`kiro-load` 自动读取配置和状态文件
- **工作连续性**：新会话可无缝继续之前的工作

## 🔧 高级功能

### 需求变更处理
```
用户：/kiro-think 客户要求增加手机号登录
AI：[分析变更影响]
用户：/kiro-change
AI：[更新相关文档] requirements.md, design.md, tasks.md
```

### 项目状态管理
```
用户：/kiro-status
AI：当前功能：用户登录系统
    当前阶段：执行阶段
    完成进度：3/8 个任务已完成
    当前分支：feature/用户登录
```

### 会话保存恢复
```
# 保存当前工作
用户：/kiro-save
AI：[生成会话恢复提示词]

# 新会话恢复
用户：/kiro-load  
AI：[自动恢复工作状态和进度]
```

## 📁 项目文件结构

安装配置后，你的项目会形成如下结构：

```
your-project/
├── CLAUDE.md                   # 全局配置文件（包含通用规则和错误处理策略）
├── .claude/                   # Claude Code 命令系统
│   └── commands/              # 10个自包含的斜杠命令
│       ├── kiro-start.md      # 🚀 功能启动（包含需求/设计/任务模板）
│       ├── kiro-next.md       # ⚡ 任务执行（包含执行逻辑和进度跟踪）
│       ├── kiro-save.md       # 💾 进度保存（包含会话管理）
│       ├── kiro-load.md       # 🔄 状态恢复（包含上下文恢复）
│       ├── kiro-think.md      # 🧠 深度分析（包含多级分析逻辑）
│       ├── kiro-change.md     # 📝 文档同步（包含原子更新逻辑）
│       ├── kiro-end.md        # 🏁 功能完成（包含归档清理）
│       ├── kiro-info.md       # ℹ️  项目配置（包含信息管理）
│       ├── kiro-status.md     # 📊 状态显示（包含进度计算）
│       └── kiro-git.md        # 🔗 代码提交（包含Git操作）
└── .specs/                    # 工作文件（使用时自动创建）
    ├── project-info.md        # 项目基本信息
    ├── session.md             # 当前会话状态
    ├── {功能名}/
    │   ├── requirements.md    # 需求文档
    │   ├── design.md         # 设计文档
    │   ├── tasks.md          # 任务列表
    │   └── session-*.md      # 归档的会话记录
    └── backups/
        └── db/               # 数据库备份文件
```

**架构优势：**
- ✅ **极简部署**：只需复制两个组件（.claude + CLAUDE.md）
- ✅ **零依赖**：每个命令都是完全自包含的
- ✅ **即用即得**：安装后立即可以使用所有功能
- ✅ **逻辑完整**：所有工作流模板和规则都内置在命令中

## 🎯 适用场景

### 最适合
- **新功能开发**：从0到1的功能实现
- **需求不明确**：通过结构化流程澄清需求
- **团队协作**：标准化的开发流程和文档
- **学习项目**：通过标准流程学习软件开发

### 不适合
- **紧急修复**：简单bug修复无需完整流程
- **实验性代码**：快速原型和概念验证
- **维护任务**：日常维护和配置调整

## 🔄 命令定制

### 修改原则
1. **保持语法一致性**：使用 `### KIRO_COMMAND_` 格式
2. **保留约束级别**：MUST（必须）、SHOULD（应该）、MAY（可以）
3. **包含错误处理**：每个命令都要有统一的错误处理机制
4. **用户交互点**：关键决策需要用户确认

### 添加新命令
1. 参考现有命令文件的格式和结构
2. 包含完整的约束条件和执行逻辑
3. 添加适当的错误处理（参考全局规则）
4. 确保命令是完全自包含的
5. 更新相关文档说明

## 💡 最佳实践

### 开发建议
- **项目信息配置**：开始前设置 `kiro-info` 项目基本信息
- **定期保存进度**：重要节点使用 `kiro-save` 保存状态
- **遵循流程**：相信 AI 的引导，完整走完各个阶段
- **及时沟通**：需求不明确时主动澄清

### 常见问题
- **数据库备份失败**：检查数据库连接配置和权限
- **Git分支冲突**：确保工作区干净后再开始新功能
- **任务进度丢失**：使用 `kiro-load` 恢复之前的会话状态
- **需求频繁变更**：使用 `kiro-think` + `kiro-change` 组合处理

## 🤝 贡献指南

欢迎为项目贡献代码和建议！

### 贡献方式
- **问题反馈**：在 Issues 中提交 bug 报告或功能建议
- **命令改进**：优化现有命令的逻辑和表达
- **新功能命令**：贡献新的工作流命令
- **文档完善**：改进使用说明和示例

### 提交规范
1. Fork 项目到个人仓库
2. 创建功能分支进行修改
3. 提交时保持命令语法一致性
4. 确保新命令是完全自包含的
5. 提供清晰的修改说明

## 📄 开源协议

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🔗 相关链接

- [GitHub 仓库](https://github.com/heihuzicity-tech/ClaudeCode-Kiro-Workflow)
- [问题反馈](https://github.com/heihuzicity-tech/ClaudeCode-Kiro-Workflow/issues)
- [Claude Code 官方文档](https://docs.anthropic.com/en/docs/claude-code)

---

**维护者**：heihuzicity-tech  
**最后更新**：2025-08-30  
**版本**：3.0.0 - 架构整合版